<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Quick Big Win Dashboard</title>

    <!-- 1. Google Fonts (ฟอนต์ Prompt) -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- 2. Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- 3. FontAwesome (ไอคอน) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- 4. Odometer CSS (ธีมตัวเลขหมุน) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/odometer.js/0.4.7/themes/odometer-theme-default.min.css" />

    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f4f6f9;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- Header Section --- */
        .top-header {
            background: white;
            padding: 15px 0;
            border-bottom: 1px solid #ddd;
            position: relative;
            z-index: 10;
        }

        .logo-img {
            height: 60px;
            width: auto;
            object-fit: contain;
            margin-right: 10px;
            transition: transform 0.2s;
        }
        .logo-img:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .logo-img { height: 40px; }
            .header-title { font-size: 1.2rem; }
            .header-subtitle { font-size: 0.8rem; }
        }
        
        .header-title {
            color: #b00d23;
            font-weight: 700;
            text-transform: uppercase;
            text-align: center;
            margin: 0;
            line-height: 1.2;
        }
        .header-subtitle {
            color: #008080;
            text-align: center;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* --- Navbar Section --- */
        .main-navbar {
            background-color: #b00d23;
            padding: 15px 0;
            white-space: nowrap;
            overflow-x: auto;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            position: relative;
            z-index: 9;
        }
        
        .nav-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            min-width: max-content;
            padding: 0 15px;
        }

        .nav-btn {
            background: rgba(255,255,255,0.15);
            color: white !important;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 50px;
            padding: 10px 25px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-btn:hover, .nav-btn.active {
            background: white;
            color: #b00d23 !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* --- Stat Cards --- */
        .stat-card {
            background: white;
            border: none;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            height: 100%;
            transition: transform 0.3s;
        }
        
        .stat-card:hover { transform: translateY(-5px); }
        
        .border-top-teal { border-top: 6px solid #20c997; }
        .border-top-red { border-top: 6px solid #dc3545; }
        .border-top-blue { border-top: 6px solid #0d6efd; }

        .main-icon { font-size: 3.5rem; margin-bottom: 20px; }
        .icon-teal { color: #20c997; }
        .icon-red { color: #dc3545; }
        .icon-blue { color: #0d6efd; }

        .odometer {
            font-size: 4.5rem;
            font-weight: 800;
            color: #333;
            line-height: 1;
        }

        .watermark-icon {
            position: absolute;
            bottom: -20px;
            right: 10px;
            font-size: 10rem;
            opacity: 0.08;
            color: #000;
            z-index: 0;
            pointer-events: none;
            transform: rotate(-15deg);
        }

        .card-content {
            position: relative;
            z-index: 2;
            padding: 40px 20px;
            text-align: center;
        }

        /* --- Footer Styles --- */
        .custom-footer {
            margin-top: auto;
            background-color: #b00d23; /* พื้นหลังสีแดง */
            color: white;
            padding: 30px 0 15px 0;
            font-size: 0.9rem;
        }
        .footer-link {
            color: white;
            text-decoration: none;
            transition: opacity 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .footer-link:hover {
            opacity: 0.8;
            color: #ffd700;
        }
        .footer-divider {
            margin: 0 10px;
            opacity: 0.5;
        }
        .copyright-text {
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 15px;
            margin-top: 20px;
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .main-navbar::-webkit-scrollbar { height: 4px; }
        .main-navbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="top-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-4 col-md-12 mb-3 mb-lg-0 text-center text-lg-start">
                    <div class="d-flex justify-content-center justify-content-lg-start gap-2">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTDH91BizHKqi00_QqEcCQ76jrBxJrRGTthfQ&s" class="logo-img" alt="R8">
                        <img src="https://skko.moph.go.th/dward/document_file/skko/common_form_upload_file/20160322201256_410195252.png" class="logo-img" alt="SKKO">
                        <img src="https://swdcph.moph.go.th/intranet/login/images/logo_swd.png" class="logo-img" alt="SWD">
                    </div>
                </div>
                
                <div class="col-lg-4 col-md-12 mb-3 mb-lg-0">
                    <h2 class="header-title">EVENT QUICK BIG WIN<br><span style="font-size: 0.8em; color:#555;">หมอพร้อม SUPER APP</span></h2>
                    <p class="header-subtitle">บูธกิจกรรมรณรงค์และรับบริจาคอวัยวะ รพร.สว่างแดนดิน <br> 24 ธันวาคม 2568</p>
                </div>

                <div class="col-lg-4 col-md-12 text-center text-lg-end">
                    <img src="https://mohpromt.moph.go.th/mpc/wp-content/uploads/2021/10/New_logo-mohpormt-01.png" class="logo-img" alt="MorProm" style="height: 55px;">
                </div>
            </div>
        </div>
    </header>

    <!-- Navbar: เชื่อมลิงก์ไปยังไฟล์ต่างๆ -->
    <div class="main-navbar">
        <div class="nav-container">
            <!-- เชื่อมลิงก์หน้าแรก -->
            <a href="index.html" class="nav-btn active"><i class="fa-solid fa-chart-line"></i> สรุปแดชบอร์ด</a>
            <!-- เชื่อมลิงก์ AI Cam -->
            <a href="ai_cam.html" class="nav-btn"><i class="fa-solid fa-video"></i> ระบบนับคน (AI)</a>
            <!-- ลิงก์บริจาค (ถ้ามีไฟล์ให้ใส่ชื่อไฟล์ แทน #) -->
            <a href="#" class="nav-btn"><i class="fa-solid fa-hand-holding-heart"></i> ลงทะเบียนบริจาค</a>
            <!-- เชื่อมลิงก์ Lucky Game -->
            <a href="lucky_game.html" class="nav-btn"><i class="fa-solid fa-gift"></i> ลุ้นรางวัล Big Win</a>
            <!-- เชื่อมลิงก์ Hero Scan -->
            <a href="hero_scan.html" class="nav-btn"><i class="fa-solid fa-user-check"></i> Digital Hero Scan</a>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div class="container mt-5 mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4 bg-white p-3 rounded shadow-sm">
            <div class="text-muted fw-bold">
                <i class="fa-regular fa-clock text-danger"></i> อัปเดตล่าสุด: <span id="current-time">--:--:--</span>
                <span id="api-status" class="badge bg-secondary ms-2">Waiting for Data...</span>
            </div>
            <button class="btn btn-outline-danger rounded-pill px-4" onclick="fetchData()">
                <i class="fa-solid fa-rotate-right me-1"></i> รีเฟรชข้อมูล
            </button>
        </div>

        <div class="row g-4">
            <!-- Card 1: ผู้เข้าชม -->
            <div class="col-md-4">
                <div class="stat-card border-top-teal">
                    <i class="fa-solid fa-users watermark-icon"></i>
                    <div class="card-content">
                        <i class="fa-solid fa-users main-icon icon-teal"></i>
                        <div class="d-block mb-2">
                            <div id="visitor-count" class="odometer">0</div>
                        </div>
                        <h5 class="text-secondary">จำนวนผู้เข้าชมบูธ (คน)</h5>
                    </div>
                </div>
            </div>

            <!-- Card 2: บริจาคอวัยวะ -->
            <div class="col-md-4">
                <div class="stat-card border-top-red">
                    <i class="fa-solid fa-heart-pulse watermark-icon"></i>
                    <div class="card-content">
                        <i class="fa-solid fa-heart-pulse main-icon icon-red"></i>
                        <div class="d-block mb-2">
                            <div id="organ-count" class="odometer">0</div>
                        </div>
                        <h5 class="text-secondary">ลงทะเบียนบริจาคอวัยวะ (ราย)</h5>
                    </div>
                </div>
            </div>

            <!-- Card 3: บริจาคดวงตา -->
            <div class="col-md-4">
                <div class="stat-card border-top-blue">
                    <i class="fa-solid fa-eye watermark-icon"></i>
                    <div class="card-content">
                        <i class="fa-solid fa-eye main-icon icon-blue"></i>
                        <div class="d-block mb-2">
                            <div id="eye-count" class="odometer">0</div>
                        </div>
                        <h5 class="text-secondary">ลงทะเบียนบริจาคดวงตา (ราย)</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer แบบใหม่ตามคำขอ -->
    <footer class="custom-footer text-center">
        <div class="container">
            <div class="row justify-content-center gy-3 mb-3">
                <div class="col-md-auto">
                    <a href="https://swdcph.moph.go.th" target="_blank" class="footer-link">
                        <i class="fa-solid fa-globe fa-lg"></i> https://swdcph.moph.go.th
                    </a>
                </div>
                <div class="col-md-auto d-none d-md-block"><span class="footer-divider">|</span></div>
                
                <div class="col-md-auto">
                    <a href="https://www.facebook.com/swdcph" target="_blank" class="footer-link">
                        <i class="fa-brands fa-facebook fa-lg"></i> โรงพยาบาลสมเด็จพระยุพราชสว่างแดนดิน
                    </a>
                </div>
                <div class="col-md-auto d-none d-md-block"><span class="footer-divider">|</span></div>

                <div class="col-md-auto">
                    <span class="footer-link">
                        <i class="fa-solid fa-phone fa-lg"></i> 042-721-111
                    </span>
                </div>
            </div>
            
            <div class="copyright-text">
                &copy; 2025 IT Nurses SWDCPH l Natnainthorn. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/odometer.js/0.4.7/odometer.min.js"></script>
    
    <script>
        // 1. ตั้งค่า Odometer
        window.odometerOptions = {
            auto: false,
            format: '(,ddd)',
            duration: 2000,
            theme: 'default'
        };

        // 2. URL ของ Google Apps Script (API)
        const API_URL = 'https://script.google.com/macros/s/AKfycbyjbm3yoBaly8pVeXKz1QTpieUe_KjjNWpatAgq_mx3jtkX7zs6vFKm8DXzBCkxNrJm/exec';

        // 3. ฟังก์ชันดึงข้อมูล (Fetch Data)
        async function fetchData() {
            const statusBadge = document.getElementById('api-status');
            
            try {
                // เรียกข้อมูลจาก API
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error('Network response was not ok');
                
                const data = await response.json();
                
                // แสดงสถานะว่าเชื่อมต่อสำเร็จ
                statusBadge.className = 'badge bg-success ms-2';
                statusBadge.innerText = 'Online (Real-time)';

                // อัปเดตข้อมูลลงหน้าเว็บ
                // หมายเหตุ: ต้องตรวจสอบว่า key ใน JSON ของคุณชื่ออะไร
                // สมมติว่าเป็น visitor, organ, eye ถ้าไม่ใช่ให้แก้ตรง data.xxx นี้ครับ
                if(data.visitor !== undefined) document.getElementById('visitor-count').innerHTML = data.visitor;
                if(data.organ !== undefined) document.getElementById('organ-count').innerHTML = data.organ;
                if(data.eye !== undefined) document.getElementById('eye-count').innerHTML = data.eye;
                
                // ถ้า API ส่งมาเป็น key อื่น ให้ใช้ console.log(data) ดูโครงสร้างก่อน
                console.log("Fetched Data:", data);

            } catch (error) {
                console.error('Error fetching data:', error);
                statusBadge.className = 'badge bg-danger ms-2';
                statusBadge.innerText = 'Connection Error';
            }
        }

        // 4. ทำงานเมื่อเปิดหน้าเว็บ
        document.addEventListener("DOMContentLoaded", function() {
            // นาฬิกา
            setInterval(() => {
                const now = new Date();
                document.getElementById('current-time').innerText = now.toLocaleTimeString('th-TH');
            }, 1000);

            // เรียกข้อมูลครั้งแรกทันที
            fetchData();

            // ตั้งเวลาให้ดึงข้อมูลใหม่ทุกๆ 5 วินาที (Real-time update)
            setInterval(fetchData, 5000); 
        });
    </script>
</body>
</html>


